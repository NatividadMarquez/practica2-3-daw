<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Practica2 3 - My Docs</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">My Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Welcome to MkDocs</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Practica2 3</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href=".." class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="2"><a href="#natividad-marquez-baena" class="nav-link">Natividad Márquez Baena</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#practica-23-proxy-inverso-con-nginx" class="nav-link">Práctica 2.3 – Proxy inverso con Nginx</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#introduccion" class="nav-link">INTRODUCCIÓN</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#configuraciones" class="nav-link">CONFIGURACIONES</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#comprobaciones" class="nav-link">COMPROBACIONES</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="natividad-marquez-baena">Natividad Márquez Baena</h2>
<h1 id="practica-23-proxy-inverso-con-nginx">Práctica 2.3 – Proxy inverso con Nginx</h1>
<ol>
<li><a href="#1">Introducción</a></li>
<li><a href="#2">Configuraciones</a></li>
<li><a href="#3">Comprobaciones</a></li>
</ol>
<div id="1"></div>
<h2 id="introduccion">INTRODUCCIÓN</h2>
<p>Un proxy es un servidor conectado a un grupo de máquinas cliente.
El servidor proxy intercepta las solicitudes de los clientes y se comunica con los servidores web actuando como intermediario de parte del cliente.
La existencia de los proxys se fundamenta en varias razones, por ejemplo, en la necesidad de evitar restricciones de navegación ante situaciones donde ecxisten restricciones de acceso a navegación web, bloquear acceso a contenido o proteger nuestra identidad en linea.</p>
<p>En esta practica se va a proceder a la creación de un proxy inverso, que es realmente el concepto contrario explicado, siendo un servidor intermedio que recibe la respuesta de varios servidores web y actuando como servidor principal para que ningun cliente se comunique directamente con el servidor o servidores.</p>
<p>Este procedimiento trae ventajas como reforzar la seguridad contra ataques, almacenamiento de caché o cifrado SSL para protección de solicitudes.</p>
<div id="2"></div>

<h2 id="configuraciones">CONFIGURACIONES</h2>
<p>Se procederá a la configuración de dos máquinas Debian. Para ello previamente se ha relizará la clonación de una de ellas para obtener dos con las que trabajar. De esta manera se utilizará el servidor que ya se ha configurado previamente. El nuevo servidor Debian que se ha clonado será configurado como proxy inverso.
Para la comprobación se realizará la busqueda en un navegador de la máquina anfitriona, hacia el proxy clonado, que debería de redirigir hacia el servidor web principal.</p>
<h3 id="nginx-en-servidor-web">Nginx en servidor web</h3>
<p>Se cambiará el nombre de la web previamente creada por webserver mediante el comando <code>mv</code></p>
<p><img alt="alt text" src="../image-1.png" /></p>
<p>Además se cambiará modificará el nombre de la web en el archivo de configuración. </p>
<p><img alt="alt text" src="../image-2.png" /></p>
<p>Posteriormente se crea un enlace simbolico llamado webserver </p>
<p><img alt="alt text" src="../image-3.png" /></p>
<p>Y se elimina el link simbolico que existía previamente.</p>
<p><img alt="alt text" src="../image-4.png" /></p>
<p>Finalmente se reinicia el sistema nginx para que se apliquen los cambios realizados.</p>
<p>Es importante modificar en el archivo hosts de la máquina anfitriona, cambiando el nombre de la web al actual.</p>
<p><img alt="alt text" src="../image-5.png" /></p>
<p>Se comprueba que es posible el acceso a la web tras los cambios y con el nuevo nombre actualizado.</p>
<h3 id="nginx-proxy-inverso">Nginx proxy inverso</h3>
<p>En la máquina clonada, se desarrollará el proxy inverso, que nos redirigirá a <code>http://webserver:8080</code>, el servidor web que acabamos de configurar para que escuche con ese nombre en el puerto 8080. </p>
<p>Para ello se crea un archivo se configuración en la ruta <code>/etc/nginx/sites-available</code> que se llamará ejemplo-proxy, y tendrá el siguiente contenido:</p>
<p><img alt="alt text" src="../image-6.png" /></p>
<p>Se detallará el puerto donde está escuchando el proxy inverso(IP), el nombre del sitio web creado anteriormente con el que accedemos en el proxy, y la directiva proxy_pass, que indica donde se redigirán las peticiones</p>
<p>Se realiza la comprobación mediante el navegador web.</p>
<p><img alt="alt text" src="../image-9.png" /></p>
<p>Posteriormente se creará el link simbólico pertinente.</p>
<p><img alt="alt text" src="../image-10.png" /></p>
<p>Finalmente se reinicia el sistema para aplicar los cambios aplicados.</p>
<p><img alt="alt text" src="../image-11.png" /></p>
<h2 id="comprobaciones">COMPROBACIONES</h2>
<p>En este apartado se pretente comprobar que la petición está pasando por el proxy inverso, que está llegando al servidor web y que vuelve por el mismo camino.
Primeramente se han de hacer las comprobaciones de que es posible acceder a la web.
Posteriormente se añadirán cabeceras HTTP personalizadas para una comprobación más exhaustiva de que las peticiones pasan tanto por el proxy inverso como por el servidor web.
Para ello se editará el archivo de configuración, tanto del webserver como del proxy inverso, añadiendo a cada uno la cabecera host. De tal manera que:</p>
<p><img alt="alt text" src="../image-12.png" />
<img alt="alt text" src="../image-13.png" /></p>
<p>Se añade al bloque <code>location /</code> la cabecera para el webserver.</p>
<p>Posteriormente se hace lo mismo para el proxy inverso:</p>
<p><img alt="alt text" src="../image-14.png" />
<img alt="alt text" src="../image-15.png" /></p>
<p>Posteriormente se reinicia el servicio de nginx para aplicar los datos, en ambas máquinas Debian.</p>
<p><img alt="alt text" src="../image-16.png" /></p>
<p>El resultado esperado es que, al inspeccionar la web, encontremos ambas cabeceras personalizadas, que nos indicarían que la petición ha pasado por los dos lados.</p>
<p>Además, es importante modificar el archivo <code>/etc/hosts</code>de la máquina con el proxy inverso, añadiendo la dirección del servidor web y la IP especifica.</p>
<p><img alt="alt text" src="../image-19.png" />
<img alt="alt text" src="../image-20.png" /></p>
<p>De esta manera, al realizar la comprobación inspeccionando la página se debería obtener el siguiente resultado <strong>( Es importante desactivar la opción de <code>desactivar caché</code> para evitar resultados inesperados ).</strong></p>
<p><img alt="alt text" src="../image-17.png" />
<img alt="alt text" src="../image-18.png" /></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
